Imaginea explicÄƒ modul Ã®n care JavaScript executÄƒ o promisiune (Promise) È™i evidenÈ›iazÄƒ cele mai importante componente ale event loop-ului È™i cozilor implicate. Hai sÄƒ trecem direct la explicaÈ›ii clare:

ğŸ§  Ce este o Promise?
O promisiune este un obiect care reprezintÄƒ finalizarea (sau eÈ™ecul) unei operaÈ›ii asincrone. Are 3 stÄƒri:

pending â€“ Ã®n aÈ™teptare

fulfilled â€“ rezolvatÄƒ cu succes

rejected â€“ a eÈ™uat

ğŸ” Ce reprezintÄƒ fiecare element din imagine:
1. Call Stack (Stiva de apeluri)
Aceasta este pila principalÄƒ unde se executÄƒ funcÈ›iile JavaScript sincron. De exemplu:

new Promise((resolve, reject) => { ... }) // Se executÄƒ aici


2. Web APIs
Aici ajung operaÈ›iile asincrone, precum setTimeout, fetch, DOM events etc. Acestea sunt gestionate de browser, nu de motorul JavaScript.

Exemplu:

setTimeout(() => resolve("Done!"), 100)

FuncÈ›ia callback este trimisÄƒ aici È™i aÈ™teaptÄƒ sÄƒ treacÄƒ timpul.

3. Task Queue (sau Callback Queue / Macrotask Queue)
DupÄƒ ce o operaÈ›ie asincronÄƒ (ex: setTimeout) s-a Ã®ncheiat, callback-ul merge Ã®n coada de task-uri, unde aÈ™teaptÄƒ sÄƒ fie preluat de event loop.

4. Microtask Queue
Aici intrÄƒ callback-urile .then(), .catch() È™i async/await imediat ce o promisiune este rezolvatÄƒ. Microtask-urile au prioritate mai mare decÃ¢t task-urile.

Exemplu:

Promise.resolve("OK").then(result => console.log(result))
// `console.log(result)` va ajunge Ã®n Microtask Queue
5. Event Loop
Este mecanismul care leagÄƒ totul:

DacÄƒ Call Stack e gol:

RuleazÄƒ tot ce este Ã®n Microtask Queue pÃ¢nÄƒ se goleÈ™te.

Abia apoi ia primul task din Task Queue.

ğŸ§ª Exemplu concret

console.log("Start");

setTimeout(() => {
  console.log("Timeout 100ms");
}, 100);

Promise.resolve("Done!").then((result) => {
  console.log(result);
});

console.log("End");

ğŸ” Ordinea de execuÈ›ie:
console.log("Start") â†’ Call Stack

setTimeout(...) â†’ Web APIs â†’ Task Queue

Promise.resolve(...).then(...) â†’ Microtask Queue

console.log("End") â†’ Call Stack

Apoi:

Microtask: console.log("Done!")

Apoi task: console.log("Timeout 100ms")

ğŸ“¤ Output final:

Start
End
Done!
Timeout 100ms
